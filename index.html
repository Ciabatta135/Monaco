<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Roblox Monaco Editor with Tabs</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      background: #1e1e2e;
      color: #fff;
      font-family: 'Fira Code', monospace;
    }
    #tabs {
      display: flex;
      background: #11111b;
      padding: 0 8px;
      border-bottom: 1px solid #444;
    }
    .tab {
      padding: 8px 12px;
      cursor: pointer;
      user-select: none;
      background: transparent;
      border: none;
      color: #c0caf5;
      display: flex;
      align-items: center;
      border-right: 1px solid #333;
    }
    .tab.active {
      background: #313244;
      font-weight: bold;
    }
    .tab .close-btn {
      margin-left: 8px;
      color: #f38ba8;
      cursor: pointer;
    }
    #addTabBtn {
      background: none;
      border: none;
      color: #89dceb;
      font-size: 20px;
      padding: 4px 12px;
      cursor: pointer;
    }
    #container {
      width: 100%;
      height: calc(100% - 40px);
    }
  </style>
</head>
<body>
  <div id="tabs">
    <!-- Tabs will be injected here -->
    <button id="addTabBtn">+</button>
  </div>
  <div id="container"></div>

  <!-- Monaco Loader -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.47.0/min/vs/loader.min.js"></script>
  <script>
    require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.47.0/min/vs' } });

    require(['vs/editor/editor.main'], function () {
      // Define theme
      monaco.editor.defineTheme('lua-dark', {
        base: 'vs-dark',
        inherit: true,
        rules: [
          { token: 'keyword', foreground: 'bb9af7' },
          { token: 'type', foreground: '7aa2f7' },
          { token: 'operator', foreground: 'bb9af7' },
          { token: 'number', foreground: 'ff9e64' },
          { token: 'string', foreground: '9ece6a' },
          { token: 'comment', foreground: '565f89' },
          { token: 'delimiter', foreground: 'c0caf5' },
          { token: 'identifier', foreground: 'c0caf5' }
        ],
        colors: {
          'editor.background': '#1a1b26'
        }
      });

      const container = document.getElementById('container');
      const tabsContainer = document.getElementById('tabs');
      const addTabBtn = document.getElementById('addTabBtn');

      let editor = null;
      const models = {};
      let tabCounter = 1;
      let currentTabId = null;

      function createTab(name, content = '') {
        const tabId = 'tab' + tabCounter++;
        const tabEl = document.createElement('button');
        tabEl.className = 'tab';
        tabEl.innerHTML = `${name} <span class="close-btn" title="Close">&#10005;</span>`;
        tabEl.dataset.tabId = tabId;

        const model = monaco.editor.createModel(content, 'lua');
        models[tabId] = { name, model };

        tabEl.addEventListener('click', (e) => {
          if (e.target.classList.contains('close-btn')) {
            closeTab(tabId);
          } else {
            switchTab(tabId);
          }
        });

        tabsContainer.insertBefore(tabEl, addTabBtn);
        switchTab(tabId);
      }

      function switchTab(tabId) {
        if (currentTabId === tabId) return;

        currentTabId = tabId;
        const tabButtons = document.querySelectorAll('.tab');
        tabButtons.forEach(btn => btn.classList.remove('active'));

        const newTab = document.querySelector(`.tab[data-tab-id="${tabId}"]`);
        if (newTab) newTab.classList.add('active');

        const model = models[tabId].model;
        editor.setModel(model);
      }

      function closeTab(tabId) {
        const model = models[tabId]?.model;
        if (model) model.dispose();
        delete models[tabId];

        const tabBtn = document.querySelector(`.tab[data-tab-id="${tabId}"]`);
        if (tabBtn) tabBtn.remove();

        if (currentTabId === tabId) {
          const remainingTabs = Object.keys(models);
          if (remainingTabs.length > 0) {
            switchTab(remainingTabs[0]);
          } else {
            editor.setModel(null);
            currentTabId = null;
          }
        }
      }

      addTabBtn.addEventListener('click', () => {
        createTab(`Script${tabCounter}`, 'print("New Script")');
      });

      editor = monaco.editor.create(container, {
        value: '',
        language: 'lua',
        theme: 'lua-dark',
        fontSize: 14,
        minimap: { enabled: false }
      });

      // Create first tab
      createTab('Script1', `print("Hello ladies and gentleman")\n\n-- Type Part. or Enum.`);

      // Autocomplete
      monaco.languages.registerCompletionItemProvider('lua', {
        provideCompletionItems: () => {
          return {
            suggestions: [
              { label: 'print', kind: monaco.languages.CompletionItemKind.Function, insertText: 'print(${1:text})', insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, documentation: "Outputs text to the console" },
              { label: 'Part.Anchored', kind: monaco.languages.CompletionItemKind.Property, insertText: 'Part.Anchored', documentation: "Property of class Part" },
              { label: 'Part.Size', kind: monaco.languages.CompletionItemKind.Property, insertText: 'Part.Size', documentation: "Property of class Part" },
              { label: 'Part.Position', kind: monaco.languages.CompletionItemKind.Property, insertText: 'Part.Position', documentation: "Property of class Part" },
              { label: 'Part.Destroy', kind: monaco.languages.CompletionItemKind.Method, insertText: 'Part:Destroy()', documentation: "Function of class Part" },
              { label: 'Model.PrimaryPart', kind: monaco.languages.CompletionItemKind.Property, insertText: 'Model.PrimaryPart', documentation: "Property of class Model" },
              { label: 'Model.SetPrimaryPartCFrame', kind: monaco.languages.CompletionItemKind.Method, insertText: 'Model:SetPrimaryPartCFrame(${1:cframe})', insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, documentation: "Sets the modelâ€™s PrimaryPart CFrame" },
              { label: 'Enum.Material', kind: monaco.languages.CompletionItemKind.EnumMember, insertText: 'Enum.Material', documentation: 'Enum value Enum.Material' },
              { label: 'Enum.Font', kind: monaco.languages.CompletionItemKind.EnumMember, insertText: 'Enum.Font', documentation: 'Enum value Enum.Font' },
              { label: 'Enum.HumanoidStateType', kind: monaco.languages.CompletionItemKind.EnumMember, insertText: 'Enum.HumanoidStateType', documentation: 'Enum value Enum.HumanoidStateType' },
              { label: 'task.spawn', kind: monaco.languages.CompletionItemKind.Function, insertText: 'task.spawn(function()\n\t$0\nend)', insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, documentation: 'Spawns a new task' },
              { label: 'game:GetService', kind: monaco.languages.CompletionItemKind.Method, insertText: 'game:GetService("${1:ServiceName}")', insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, documentation: 'Returns a service from the game' }
            ]
          };
        }
      });
    });
  </script>
</body>
</html>
